<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-data-modeling/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Data Modeling with Cube | WDC 2025 Cube Semantic Layer Workshop</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cube-js.github.io/cube-workshop/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://cube-js.github.io/cube-workshop/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://cube-js.github.io/cube-workshop/docs/data-modeling"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Modeling with Cube | WDC 2025 Cube Semantic Layer Workshop"><meta data-rh="true" name="description" content="Data modeling is the foundation of any analytics application. In Cube, you define measures (what you want to calculate) and dimensions (how you want to group and filter) to create a semantic layer over your raw data.  The logic is organized into cubes which represent logical datasets, generally mapping one-to-one with tables in a star schema."><meta data-rh="true" property="og:description" content="Data modeling is the foundation of any analytics application. In Cube, you define measures (what you want to calculate) and dimensions (how you want to group and filter) to create a semantic layer over your raw data.  The logic is organized into cubes which represent logical datasets, generally mapping one-to-one with tables in a star schema."><link data-rh="true" rel="icon" href="/cube-workshop/img/cube-icon.svg"><link data-rh="true" rel="canonical" href="https://cube-js.github.io/cube-workshop/docs/data-modeling"><link data-rh="true" rel="alternate" href="https://cube-js.github.io/cube-workshop/docs/data-modeling" hreflang="en"><link data-rh="true" rel="alternate" href="https://cube-js.github.io/cube-workshop/docs/data-modeling" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Data Modeling with Cube","item":"https://cube-js.github.io/cube-workshop/docs/data-modeling/"}]}</script><link rel="stylesheet" href="/cube-workshop/assets/css/styles.e7fe3a88.css">
<script src="/cube-workshop/assets/js/runtime~main.ae6732e1.js" defer="defer"></script>
<script src="/cube-workshop/assets/js/main.cee8d007.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/cube-workshop/img/cube-logo.svg"><link rel="preload" as="image" href="/cube-workshop/img/cube-logo-dark.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cube-workshop/"><div class="navbar__logo"><img src="/cube-workshop/img/cube-logo.svg" alt="Cube Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cube-workshop/img/cube-logo-dark.svg" alt="Cube Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">WDC 2025 Cube Semantic Layer Workshop</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cube-workshop/docs/intro">Workshop</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/cube-js/cube-workshop" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://cube.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Cube.dev<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cube-workshop/docs/intro">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cube-workshop/docs/setup">Workshop Setup</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/cube-workshop/docs/data-modeling">Workshop Exercises</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cube-workshop/docs/data-modeling">Data Modeling with Cube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cube-workshop/docs/access-control">Access Control with Cube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cube-workshop/docs/caching">Caching with Cube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cube-workshop/docs/apis">APIs: Multiple Ways to Access Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cube-workshop/docs/react-app">Building a React Dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cube-workshop/docs/d3-analytics">D3 Agentic Analytics</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cube-workshop/docs/resources">Resources &amp; Next Steps</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cube-workshop/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Workshop Exercises</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Data Modeling with Cube</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Modeling with Cube</h1></header>
<p>Data modeling is the foundation of any analytics application. In Cube, you define <strong>measures</strong> (what you want to calculate) and <strong>dimensions</strong> (how you want to group and filter) to create a semantic layer over your raw data.  The logic is organized into <strong>cubes</strong> which represent logical datasets, generally mapping one-to-one with tables in a star schema.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-data-modeling-matters">Why Data Modeling Matters<a href="#why-data-modeling-matters" class="hash-link" aria-label="Direct link to Why Data Modeling Matters" title="Direct link to Why Data Modeling Matters">‚Äã</a></h2>
<p>Instead of writing SQL queries directly against your database, Cube&#x27;s data modeling approach provides:</p>
<ul>
<li><strong>Reusable metrics</strong> - Model once, deliver anywhere</li>
<li><strong>Consistent definitions</strong> - No more &quot;which revenue number is correct?&quot;</li>
<li><strong>Business logic encapsulation</strong> - Complex calculations and join logic in one place</li>
<li><strong>Software development best practices</strong> - Version control (git integration), testing, and collaboration</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-tpc-h-schema">The TPC-H Schema<a href="#the-tpc-h-schema" class="hash-link" aria-label="Direct link to The TPC-H Schema" title="Direct link to The TPC-H Schema">‚Äã</a></h2>
<p>Our workshop uses the standard TPC-H schema representing a B2B e-commerce business:</p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="visualizing-the-tpc-h-schema-in-cube">Visualizing the TPC-H Schema in Cube<a href="#visualizing-the-tpc-h-schema-in-cube" class="hash-link" aria-label="Direct link to Visualizing the TPC-H Schema in Cube" title="Direct link to Visualizing the TPC-H Schema in Cube">‚Äã</a></h2>
<p>Here&#x27;s how it looks in Cube&#x27;s visual modeler:</p>
<p><img decoding="async" loading="lazy" alt="TPC-H schema in Cube visual modeler" src="/cube-workshop/assets/images/visual_model-02cc4d20d5382375d5ec4c2aa1a56813.png" width="3006" height="1706" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="your-first-query">Your First Query<a href="#your-first-query" class="hash-link" aria-label="Direct link to Your First Query" title="Direct link to Your First Query">‚Äã</a></h2>
<p>Let&#x27;s start with a query to see how Cube works. In your Cube Cloud workspace:</p>
<ol>
<li><strong>Navigate to the Playground</strong> (left sidebar)</li>
<li><strong>Expand</strong> the <code>orders</code> cube</li>
<li><strong>Add a measure</strong>: Click the field <code>count</code></li>
<li><strong>Add a dimension</strong>: Click the <code>order_date</code> field, select <code>year</code> as the granularity</li>
<li><strong>Click &quot;Run Query&quot;</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="Screenshot: Playground query results showing order count by year" src="/cube-workshop/assets/images/playground-c11179bf0f5ec9121824853e96e8d65d.png" width="2994" height="1720" class="img_ev3q"></p>
<p>You should see a time series of order counts.  Check out the tabs for <strong>SQL API</strong>, <strong>REST API</strong>, and <strong>GraphQL API</strong> (middle of the screen) - these show how to issue this query to those APIs respectively.  Simple syntax, right?</p>
<p>Now click on the <strong>Generated SQL</strong> tab - this is the query that Cube generates which goes back to our PostgreSQL database.</p>
<p>Let&#x27;s <strong>add another field to the query</strong>.  From the <code>regions</code> cube, click the <code>name</code> field.  Now check those API tabs again.  The &quot;Semantic SQL&quot; (what we see on the <strong>SQL API</strong> tab) is simple - you&#x27;re just asking for fields without worrying about the join logic which we&#x27;ve already defined and is now part of the data model.</p>
<p>On the <strong>Generated SQL</strong> tab, the query is now much more complex as the joins traverse a few tables to go from <code>orders</code> -&gt; <code>customers</code> -&gt; <code>nations</code> -&gt; <code>regions</code> but as a semantic layer end user, we are able to simply re-use the logic that was already setup ahead of time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-concepts">Core Concepts<a href="#core-concepts" class="hash-link" aria-label="Direct link to Core Concepts" title="Direct link to Core Concepts">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-we-skipped-starting-from-scratch">What We Skipped: Starting From Scratch<a href="#what-we-skipped-starting-from-scratch" class="hash-link" aria-label="Direct link to What We Skipped: Starting From Scratch" title="Direct link to What We Skipped: Starting From Scratch">‚Äã</a></h3>
<p>In this workshop, we started with an existing data model to save time. When building a Cube project from scratch, you&#x27;d typically:</p>
<ol>
<li><strong>Use the Connection Wizard</strong> - Cube guides you through connecting to your database</li>
<li><strong>Select Tables</strong> - Choose which tables to model from your database schema</li>
<li><strong>Generate Initial Cubes</strong> - Cube automatically creates a cube for each selected table with:<!-- -->
<ul>
<li>Basic dimensions for each column</li>
<li>A <code>count</code> measure</li>
<li>Detected data types (string, number, time)</li>
</ul>
</li>
<li><strong>Infer Relationships</strong> - Cube analyzes foreign keys and suggests join relationships</li>
<li><strong>Refine and Customize</strong> - Add business logic, custom measures, and meaningful descriptions</li>
</ol>
<p>This automated process gives you a solid foundation that you can then enhance with business-specific logic - exactly where we started in this workshop!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cubes-data-models">Cubes (Data Models)<a href="#cubes-data-models" class="hash-link" aria-label="Direct link to Cubes (Data Models)" title="Direct link to Cubes (Data Models)">‚Äã</a></h3>
<p>A <strong>Cube</strong> represents a table or logical dataset. Cubes typically map 1-to-1 with tables in a star schema, but are also flexible.  For TPCH:</p>
<ul>
<li><code>orders</code> - Purchase orders from customers</li>
<li><code>customers</code> - B2B companies buying parts</li>
<li><code>line_items</code> - Individual products within orders</li>
<li><code>parts</code> - Industrial components catalog</li>
<li>etc.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="measures">Measures<a href="#measures" class="hash-link" aria-label="Direct link to Measures" title="Direct link to Measures">‚Äã</a></h3>
<p><strong>Measures</strong> are aggregated values - the &quot;what you want to calculate&quot;.  They can be simple counts or complex calculations. You can reference other measures in their definitions, allowing for powerful reusability and composability.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">measures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> total_revenue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> extended_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> currency</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> average_order_value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE.total_revenue} / {CUBE.count}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> currency</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dimensions">Dimensions<a href="#dimensions" class="hash-link" aria-label="Direct link to Dimensions" title="Direct link to Dimensions">‚Äã</a></h3>
<p><strong>Dimensions</strong> are attributes for grouping and filtering - the &quot;how you want to group/filter the measures&quot;. They can be simple fields or complex derived values.:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">dimensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> order_date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> o_orderdate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">DATE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customer_segment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> c_mktsegment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> order_size_bins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      CASE </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        WHEN {CUBE}.o_totalprice &lt; 50000 THEN &#x27;Small Orders&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        WHEN {CUBE}.o_totalprice &lt; 150000 THEN &#x27;Medium Orders&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        WHEN {CUBE}.o_totalprice &lt; 300000 THEN &#x27;Large Orders&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        ELSE &#x27;Enterprise Orders&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      END</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Order value categories for business analysis&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-mode-vs-production">Development Mode vs Production<a href="#development-mode-vs-production" class="hash-link" aria-label="Direct link to Development Mode vs Production" title="Direct link to Development Mode vs Production">‚Äã</a></h2>
<p>Before making any changes to your data model, it&#x27;s important to understand Cube&#x27;s development workflow. This ensures you can safely experiment and test changes without affecting your production deployment.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-cube-development-workflow">Understanding the Cube Development Workflow<a href="#understanding-the-cube-development-workflow" class="hash-link" aria-label="Direct link to Understanding the Cube Development Workflow" title="Direct link to Understanding the Cube Development Workflow">‚Äã</a></h3>
<p>Cube Cloud provides two distinct environments:</p>
<ul>
<li><strong>Production Environment</strong>: The live, deployed version of your data model that serves real users and applications</li>
<li><strong>Development Environment</strong>: An isolated workspace where you can make and test changes safely</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="entering-development-mode">Entering Development Mode<a href="#entering-development-mode" class="hash-link" aria-label="Direct link to Entering Development Mode" title="Direct link to Entering Development Mode">‚Äã</a></h3>
<p>Before modifying any data model files, you need to enter <strong>Development Mode</strong>:</p>
<ol>
<li><strong>Navigate to the Data Model page</strong> in your Cube workspace</li>
<li><strong>Click the &quot;Dev Mode&quot; button</strong> (top of the interface)</li>
<li><strong>Choose your branch strategy</strong>:<!-- -->
<ul>
<li><strong>Create a new branch</strong> - Recommended for new features (<code>feature/sales-view</code>)</li>
<li><strong>Use existing branch</strong> - If continuing previous work</li>
</ul>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Entering Development Mode" src="/cube-workshop/assets/images/dev-mode-entry-a56e3f419918dd0cc83ebb5c9bfcf902.png" width="3678" height="1214" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-development-mode-enables">What Development Mode Enables<a href="#what-development-mode-enables" class="hash-link" aria-label="Direct link to What Development Mode Enables" title="Direct link to What Development Mode Enables">‚Äã</a></h3>
<p>Once in development mode, you get:</p>
<ul>
<li><strong>üîí Isolated Environment</strong>: Changes don&#x27;t affect production users</li>
<li><strong>üîÑ Hot Reload</strong>: The development API automatically reflects your changes</li>
<li><strong>üåø Git Integration</strong>: All committed changes are tracked on your development branch</li>
<li><strong>üß™ Safe Testing</strong>: Test queries and applications against your changes before you even commit</li>
<li><strong>üë• Collaboration</strong>: Multiple developers can work on different branches</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="development-api-endpoint">Development API Endpoint<a href="#development-api-endpoint" class="hash-link" aria-label="Direct link to Development API Endpoint" title="Direct link to Development API Endpoint">‚Äã</a></h3>
<p>In development mode, you&#x27;ll see a separate API endpoint for testing:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Production API (for live apps)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://your-workspace.cubecloud.dev/cubejs-api/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Development API (for testing changes)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://your-workspace.cubecloud.dev/dev-branch-name/cubejs-api/v1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="making-changes-safely">Making Changes Safely<a href="#making-changes-safely" class="hash-link" aria-label="Direct link to Making Changes Safely" title="Direct link to Making Changes Safely">‚Äã</a></h3>
<p>While in development mode:</p>
<ol>
<li><strong>Edit your data model files</strong> - Add measures, dimensions, cubes, or views</li>
<li><strong>Test in Playground</strong> - Queries automatically use your development branch</li>
<li><strong>Validate with applications</strong> - Point your app to the development API endpoint</li>
<li><strong>Iterate quickly</strong> - Changes appear within seconds without deployment delays</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Development Best Practices</div><div class="admonitionContent_BuS1"><ul>
<li>Always work in development mode when making changes</li>
<li>Use descriptive branch names like <code>feature/customer-metrics</code> or <code>fix/revenue-calculation</code></li>
<li>Test thoroughly before merging to production</li>
<li>Keep development branches focused on specific features or fixes</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="committing-and-deploying-to-production">Committing and Deploying to Production<a href="#committing-and-deploying-to-production" class="hash-link" aria-label="Direct link to Committing and Deploying to Production" title="Direct link to Committing and Deploying to Production">‚Äã</a></h3>
<p>After testing your changes and confirming they work correctly:</p>
<p><strong>Step 1: Commit Your Changes</strong></p>
<ol>
<li>On the Data Model page, <strong>Review your changes</strong> in the Data Model IDE</li>
<li><strong>Click &quot;Commit &amp; Sync&quot;</strong> to save your changes to the development branch</li>
<li><strong>Add a commit message</strong> describing what you built</li>
<li><strong>Click &quot;Commit &amp; Sync&quot;</strong> in the modal to proceed.</li>
<li>The data model is now committed on your branch.  If you want to make more changes before merging, you can just continue your development, knowing your progress is saved with git.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Commit button" src="/cube-workshop/assets/images/commit-button-e66957477b1a84fa2dec82c9de3aabc2.png" width="1511" height="377" class="img_ev3q"></p>
<p><strong>Step 2: Merge to Production</strong></p>
<ol>
<li>Still on the Data Model page, <strong>Click the Merge button</strong> (same spot as Commit)</li>
<li><strong>Enter a message</strong> to describe the changes</li>
<li>Unless you have a reason to keep it, check the box for <strong>Delete -dev- branch</strong></li>
<li><strong>Click Merge</strong> to proceed</li>
<li>You&#x27;re now back in main looking at your production data model.  To continue development work, click on <strong>Dev Mode</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="Merge Modal" src="/cube-workshop/assets/images/merge-modal-17caacbac9c7eb0b1ce5e73addebe487.png" width="1418" height="668" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Git Integration Required</div><div class="admonitionContent_BuS1"><p>This workshop uses a default (but private) Cube repository for your deployment.  In practice, you would usually connect to your own git repository on GitHub/GitLab/etc.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-this-workflow-matters">Why This Workflow Matters<a href="#why-this-workflow-matters" class="hash-link" aria-label="Direct link to Why This Workflow Matters" title="Direct link to Why This Workflow Matters">‚Äã</a></h3>
<p>This development-to-production workflow provides:</p>
<ul>
<li><strong>üõ°Ô∏è Risk Mitigation</strong>: Never break production with experimental changes</li>
<li><strong>üîÑ Rollback Capability</strong>: Easy to revert changes if issues arise</li>
<li><strong>üìù Change Tracking</strong>: Full audit trail of who changed what and when</li>
<li><strong>üß™ Testing Environment</strong>: Validate changes before users see them</li>
<li><strong>üë• Team Collaboration</strong>: Multiple developers can work safely in parallel</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="your-first-data-model">Your First Data Model<a href="#your-first-data-model" class="hash-link" aria-label="Direct link to Your First Data Model" title="Direct link to Your First Data Model">‚Äã</a></h2>
<p>Now that you understand the development workflow, let&#x27;s enhance the <code>orders</code> cube with business-relevant metrics. <strong>Remember to enter Development Mode now!</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-add-revenue-metrics">Exercise: Add Revenue Metrics<a href="#exercise-add-revenue-metrics" class="hash-link" aria-label="Direct link to Exercise: Add Revenue Metrics" title="Direct link to Exercise: Add Revenue Metrics">‚Äã</a></h3>
<ol>
<li>Navigate to the Data Model page in your Cube workspace</li>
<li>Select the <code>model/cubes/orders.yml</code> file to see the code for that cube</li>
<li>Add these two measures to the <code>measures:</code> block.  Indentation is important in yaml so make sure they align with the <code>count</code> measure:</li>
</ol>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/orders.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">measures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> total_revenue</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> o_totalprice</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sum</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> currency</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Total revenue from all orders&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> average_order_value</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE.total_revenue} / {CUBE.count}&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> currency</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Average revenue per order&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dimensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> o_orderkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">primary_key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-your-model-in-the-playground">Test Your Model in the Playground<a href="#test-your-model-in-the-playground" class="hash-link" aria-label="Direct link to Test Your Model in the Playground" title="Direct link to Test Your Model in the Playground">‚Äã</a></h3>
<ol>
<li><strong>Save</strong> the cube definition in your Cube IDE</li>
<li><strong>Navigate to Playground</strong> (left sidebar)</li>
<li><strong>Build and test each query</strong>:<!-- -->
<ul>
<li><strong>Revenue by month</strong>: Add <code>orders.total_revenue</code> measure + <code>orders.order_date</code> dimension</li>
<li><strong>Order value by priority</strong>: Add <code>orders.average_order_value</code> measure + <code>orders.priority</code> dimension</li>
<li><strong>Order count by status</strong>: Add <code>orders.count</code> measure + <code>orders.status</code> dimension</li>
</ul>
</li>
<li><strong>Click &quot;Run Query&quot;</strong> to execute</li>
<li><strong>View the chart</strong> to visualize your results</li>
<li><strong>Check the SQL API and Generated SQL tabs</strong> to see how Cube rewrites your semantic query into optimized SQL</li>
</ol>
<p><strong>Key Learning</strong>: Notice how the Generated SQL is much more complex than the simple semantic query you built in the interface. Cube lets you define the fields once and show the end users only the handles all the complexity for you!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-power-of-reusability">The Power of Reusability<a href="#the-power-of-reusability" class="hash-link" aria-label="Direct link to The Power of Reusability" title="Direct link to The Power of Reusability">‚Äã</a></h3>
<p>Notice how <code>average_order_value</code> reuses the <code>total_revenue</code> and <code>count</code> measures? This is the DRY principle in action - change the revenue calculation once, and all dependent metrics update automatically.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="joins-and-relationships">Joins and Relationships<a href="#joins-and-relationships" class="hash-link" aria-label="Direct link to Joins and Relationships" title="Direct link to Joins and Relationships">‚Äã</a></h2>
<p>Cube automatically handles join traversals when you query fields from different cubes. These joins in the <code>orders</code> cube create a relationship from <code>orders</code> to <code>customers</code> and from <code>orders</code> to <code>line_items</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> many_to_one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.o_custkey = {customers}.c_custkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> one_to_many</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.o_orderkey = {line_items}.l_orderkey&quot;</span><br></span></code></pre></div></div>
<p><strong>What this enables:</strong></p>
<ul>
<li><strong>Cross-cube queries</strong>: Query <code>orders.count</code> grouped by <code>line_items.part_key</code></li>
<li><strong>Aggregate rollups</strong>: Sum line item values up to the order level</li>
<li><strong>Complex analytics</strong>: Compare order totals vs. sum of line item prices</li>
<li><strong>Automatic JOIN logic</strong>: Cube handles all the SQL complexity behind the scenes</li>
</ul>
<p>The <code>one_to_many</code> direction tells Cube that one order contains many line items, which prevents fan-out issues when aggregating order-level measures.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">‚Äã</a></h2>
<ol>
<li><strong>Start simple</strong> - Begin with basic counts and sums - building blocks for your analytics</li>
<li><strong>Use descriptive names</strong> - <code>total_revenue</code> not <code>tr</code></li>
<li><strong>Add descriptions</strong> - Help users and agents understand metrics</li>
<li><strong>Use titles</strong> - Provide user-friendly titles for measures and dimensions as needed</li>
<li><strong>Format appropriately</strong> - Currency, percentages, etc.</li>
<li><strong>Think reusability</strong> - Build metrics that are additive and compose well - minimize use of &quot;average&quot; or &quot;count_distinct&quot; unless necessary</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Use a <strong>sum measure</strong> and a <strong>count measure</strong> instead of an average. Cube can cache the additive components and compute the final average on the fly.</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Instead of <code>count_distinct</code>, where possible, use the <code>count</code> measure in a joined cube where that dimension is the primary key. Cube will automatically deduplicate the results, and the additive <code>count</code> measure can be used efficiently by pre-aggregations (we&#x27;ll cover this more in the caching section).</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-cube-parameters">Common Cube Parameters<a href="#common-cube-parameters" class="hash-link" aria-label="Direct link to Common Cube Parameters" title="Direct link to Common Cube Parameters">‚Äã</a></h2>
<p>Beyond measures and dimensions, Cube offers several parameters to enhance your data model:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="visibility-control">Visibility Control<a href="#visibility-control" class="hash-link" aria-label="Direct link to Visibility Control" title="Direct link to Visibility Control">‚Äã</a></h3>
<p><code>public: false</code> - Hides the object from end users by not exposing it through the APIs - it&#x27;s only visible in the playground.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> base_cube</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> base_table </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">public</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Hide from end users</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Internal cube for low-level calculations only&quot;</span><br></span></code></pre></div></div>
<p><strong>Use cases:</strong></p>
<ul>
<li><strong>Building blocks</strong> - Hide bridge or base cubes, or intermediate calculations</li>
<li><strong>Expose views only</strong> - Cubes are usually used as building blocks, with only views exposed to end users</li>
<li><strong>Dynamic Security</strong> - Use with a dynamic function to control visibility based on user&#x27;s security context</li>
<li><strong>Gradual rollout</strong> - Keep new objects hidden until ready</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-for-discovery">Metadata for Discovery<a href="#metadata-for-discovery" class="hash-link" aria-label="Direct link to Metadata for Discovery" title="Direct link to Metadata for Discovery">‚Äã</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Customer Orders&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;All customer orders with order-level metrics&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">meta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">category</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Sales&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;annie@tpch.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">sla</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Updated hourly&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;core&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;financial&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p><strong>Business value:</strong></p>
<ul>
<li><strong>Discoverability</strong> - Help users find the right data</li>
<li><strong>Documentation</strong> - Self-documenting data models</li>
<li><strong>Governance</strong> - Track ownership and update frequency</li>
<li><strong>AI/LLM Integration</strong> - Metadata helps AI tools understand your data</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-flexibility">SQL Flexibility<a href="#sql-flexibility" class="hash-link" aria-label="Direct link to SQL Flexibility" title="Direct link to SQL Flexibility">‚Äã</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> complex_metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      SELECT * FROM (</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        SELECT </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          customer_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          order_date,</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          RANK() OVER (PARTITION BY customer_id ORDER BY order_date) as order_rank</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        FROM orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      ) ranked_orders</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Use a subquery instead of a table</span><br></span></code></pre></div></div>
<p><strong>When to use:</strong></p>
<ul>
<li><strong>Window functions</strong> - Pre-calculate rankings or running totals</li>
<li><strong>Complex CTEs</strong> - Embed business logic in the source query</li>
<li><strong>Performance optimization</strong> - Push calculations to the database</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="refresh-keys-for-cache-invalidation">Refresh Keys for Cache Invalidation<a href="#refresh-keys-for-cache-invalidation" class="hash-link" aria-label="Direct link to Refresh Keys for Cache Invalidation" title="Direct link to Refresh Keys for Cache Invalidation">‚Äã</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">refresh_key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">every</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1 hour  </span><span class="token comment" style="color:#999988;font-style:italic"># Check for updates hourly</span><br></span></code></pre></div></div>
<p><strong>Benefits:</strong></p>
<ul>
<li><strong>Fresh data</strong> - Control how often Cube checks for changes</li>
<li><strong>Performance</strong> - Balance freshness with query performance</li>
<li><strong>Cost optimization</strong> - Reduce unnecessary database queries</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-source-routing">Data Source Routing<a href="#data-source-routing" class="hash-link" aria-label="Direct link to Data Source Routing" title="Direct link to Data Source Routing">‚Äã</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> historical_orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">data_source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> warehouse  </span><span class="token comment" style="color:#999988;font-style:italic"># Route to different database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> orders_archive</span><br></span></code></pre></div></div>
<p><strong>Use cases:</strong></p>
<ul>
<li><strong>Multi-database setups</strong> - Route queries to different data sources or db schemas based on the user security context - this is common in multi-tenant applications</li>
<li><strong>Hybrid architectures</strong> - Mix real-time and warehouse data</li>
<li><strong>Cost optimization</strong> - Route heavy queries to read replicas</li>
<li><strong>Data locality</strong> - Keep regional data in regional databases</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercises">Exercises<a href="#exercises" class="hash-link" aria-label="Direct link to Exercises" title="Direct link to Exercises">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-1-complete-the-missing-join">Exercise 1: Complete the Missing Join<a href="#exercise-1-complete-the-missing-join" class="hash-link" aria-label="Direct link to Exercise 1: Complete the Missing Join" title="Direct link to Exercise 1: Complete the Missing Join">‚Äã</a></h3>
<p>In the starter data model, we&#x27;ve intentionally left out one join. Add the missing relationship between <code>orders</code> and <code>line_items</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/orders.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> many_to_one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.o_custkey = {customers}.c_custkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> one_to_many</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.o_orderkey = {line_items}.l_orderkey&quot;</span><br></span></code></pre></div></div>
<p><strong>Understanding the relationship:</strong></p>
<ul>
<li><strong>Direction</strong>: <code>one_to_many</code> means one order contains many line items</li>
<li><strong>Business logic</strong>: This allows you to analyze orders by their component parts and run subqueries against line items</li>
<li><strong>Fan-out prevention</strong>: Cube knows to handle aggregation correctly across this relationship</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-2-add-subquery-dimensions">Exercise 2: Add Subquery Dimensions<a href="#exercise-2-add-subquery-dimensions" class="hash-link" aria-label="Direct link to Exercise 2: Add Subquery Dimensions" title="Direct link to Exercise 2: Add Subquery Dimensions">‚Äã</a></h3>
<p>Now let&#x27;s use that new relationship to create a subquery. Subqueries are useful for cases like aggregating measures from a lower grain to a cube at a higher grain.  Subqueries are always dimensions and they are generally used to reference a measure in a related cube. Add this dimension to your <code>orders</code> cube:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/orders.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> o_comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> items_in_order</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{line_items.count}&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Number of line items in this order&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sub_query</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> many_to_one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.o_custkey = {customers}.c_custkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre></div></div>
<p><strong>Test in Playground</strong>:</p>
<ol>
<li><strong>Save</strong> the updated orders.yml</li>
<li><strong>Query</strong>: <code>orders.count</code> grouped by <code>orders.items_in_order</code></li>
<li><strong>Visualize</strong> the distribution of order complexity (hint: use the <code>Order</code> button to change the sort fields and direction)</li>
<li><strong>Generated SQL tab</strong>: See how Cube handles the subquery in the dimension</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-3-business-logic-with-binning">Exercise 3: Business Logic with Binning<a href="#exercise-3-business-logic-with-binning" class="hash-link" aria-label="Direct link to Exercise 3: Business Logic with Binning" title="Direct link to Exercise 3: Business Logic with Binning">‚Äã</a></h3>
<p>Create business-friendly categories by adding binning dimensions.  Instead of defining these over and over again for every BI tool and database connection, we can define them once in Cube and reuse them everywhere.  Add this dimension to your <code>orders</code> cube:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/orders.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> items_in_order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{line_items.count}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Number of line items in this order&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sub_query</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> order_size_category</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          CASE </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            WHEN {CUBE}.o_totalprice &lt; 50000 THEN &#x27;Small&#x27;</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            WHEN {CUBE}.o_totalprice &lt; 100000 THEN &#x27;Medium&#x27;</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            WHEN {CUBE}.o_totalprice &lt; 200000 THEN &#x27;Large&#x27;</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            ELSE &#x27;Enterprise&#x27;</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          END</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Order size categories for business analysis&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> many_to_one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.o_custkey = {customers}.c_custkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre></div></div>
<p><strong>Test in Playground</strong>:</p>
<ol>
<li><strong>Save</strong> and <strong>query</strong>: <code>orders.total_revenue</code> by <code>orders.order_size_category</code></li>
<li><strong>Use a bar chart</strong> to visualize revenue distribution - expand the <strong>Chart</strong> section of the playground and click the <strong>Bar</strong> chart type</li>
<li><strong>Generated SQL</strong>: Notice the CASE statement integration</li>
<li><strong>Business insight</strong>: Which order sizes generate the most revenue?</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-4-multi-level-measure-dependencies">Exercise 4: Multi-Level Measure Dependencies<a href="#exercise-4-multi-level-measure-dependencies" class="hash-link" aria-label="Direct link to Exercise 4: Multi-Level Measure Dependencies" title="Direct link to Exercise 4: Multi-Level Measure Dependencies">‚Äã</a></h3>
<p>Create a business-critical metric using subqueries and measure dependencies. Let&#x27;s build <strong>Average Customer Value (ACV)</strong> in the customers cube:</p>
<p><strong>Step 1: Add a subquery dimension to customers.yml</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/customers.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> c_comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> lifetime_value</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{orders.total_revenue}&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> currency</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Total revenue from all orders for this customer&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sub_query</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customer_nations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> many_to_one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.c_nationkey = {customer_nations}.n_nationkey&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre></div></div>
<p><strong>Step 2: Add the ACV measure to customers.yml</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/customers.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">measures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> average_customer_value</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE.lifetime_value}&quot;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> avg</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> currency</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ACV - Average revenue per customer across all customers&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dimensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customer_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> c_custkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">primary_key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre></div></div>
<p><strong>Test in Playground</strong>:</p>
<ol>
<li><strong>Save</strong> the updated customers.yml</li>
<li><strong>Query</strong>: <code>customers.average_customer_value</code> grouped by <code>customers.segment</code></li>
<li><strong>Generated SQL tab</strong>: Notice how Cube:<!-- -->
<ul>
<li>Creates a subquery to calculate each customer&#x27;s lifetime value</li>
<li>Then averages those totals across all customers</li>
<li>Handles the complex multi-level aggregation automatically</li>
</ul>
</li>
<li><strong>Business insight</strong>: Which customer segments have the highest ACV?</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-relationships--fan-outs">Understanding Relationships &amp; Fan-Outs<a href="#understanding-relationships--fan-outs" class="hash-link" aria-label="Direct link to Understanding Relationships &amp; Fan-Outs" title="Direct link to Understanding Relationships &amp; Fan-Outs">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-relationship-direction-matters">Why Relationship Direction Matters<a href="#why-relationship-direction-matters" class="hash-link" aria-label="Direct link to Why Relationship Direction Matters" title="Direct link to Why Relationship Direction Matters">‚Äã</a></h3>
<p>Proper join relationships prevent <strong>fan-outs</strong> and <strong>chasm traps</strong>.  Let&#x27;s use the <code>orders</code> cube as an example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ‚úÖ Correct - prevents fan-out</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> many_to_one  </span><span class="token comment" style="color:#999988;font-style:italic"># Many orders belong to one customer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.customer_key = {customers}.customer_key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ‚úÖ Correct - one-to-many relationship  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">joins</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">relationship</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> one_to_many   </span><span class="token comment" style="color:#999988;font-style:italic"># One order has many line items</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{CUBE}.order_key = {line_items}.order_key&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fan-out-prevention">Fan-Out Prevention<a href="#fan-out-prevention" class="hash-link" aria-label="Direct link to Fan-Out Prevention" title="Direct link to Fan-Out Prevention">‚Äã</a></h3>
<p>Without proper relationships, queries can produce incorrect results:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Without proper joins, this query might double-count</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> order_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">line_item_revenue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> total_revenue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> orders o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">JOIN</span><span class="token plain"> line_items li </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> o</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">order_key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> li</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">order_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Result: order_count is inflated by number of line items per order!</span><br></span></code></pre></div></div>
<p>Cube&#x27;s relationship declarations automatically handle this by:</p>
<ul>
<li>Using appropriate <code>JOIN</code> vs <code>LEFT JOIN</code></li>
<li>Adding <code>DISTINCT</code> where necessary</li>
<li>Optimizing subqueries to prevent multiplicative effects</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-power-of-extends">The Power of Extends<a href="#the-power-of-extends" class="hash-link" aria-label="Direct link to The Power of Extends" title="Direct link to The Power of Extends">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-our-model-uses-extends">Why Our Model Uses Extends<a href="#why-our-model-uses-extends" class="hash-link" aria-label="Direct link to Why Our Model Uses Extends" title="Direct link to Why Our Model Uses Extends">‚Äã</a></h3>
<p>In the TPC-H data model, you&#x27;ll notice patterns like <code>customer_nations</code> and <code>supplier_nations</code>. These use Cube&#x27;s <strong>extends</strong> feature:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/nations.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Base nation cube with all dimensions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> customer_nations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Inherits all measures and dimensions from nations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> supplier_nations  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Another extension of the same base cube</span><br></span></code></pre></div></div>
<p><strong>Why is this powerful?</strong></p>
<ol>
<li>
<p><strong>Avoid Ambiguous Joins</strong> - When both customers and suppliers connect to nations, Cube needs to know which path to take. Extended cubes make this explicit.</p>
</li>
<li>
<p><strong>Maintain DRY Principle</strong> - Define nation dimensions once, reuse everywhere. Change the definition in one place, all extensions update automatically.</p>
</li>
<li>
<p><strong>Enable Complex Analytics</strong> - Query customers by their nation AND suppliers by their nation in the same query without confusion.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="date-tables-a-common-use-case-for-extends">Date Tables: A Common Use Case for Extends<a href="#date-tables-a-common-use-case-for-extends" class="hash-link" aria-label="Direct link to Date Tables: A Common Use Case for Extends" title="Direct link to Date Tables: A Common Use Case for Extends">‚Äã</a></h3>
<p>Extends really shine with date dimensions. Instead of maintaining separate date logic for each timestamp:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/cubes/dates.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sql_table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> date_dimension</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dimensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> date_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fiscal_quarter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fiscal_quarter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> holiday_flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> is_holiday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> order_dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Full date dimension capabilities for order dates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ship_dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dates  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Same capabilities for ship dates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> return_dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># And return dates</span><br></span></code></pre></div></div>
<p>Now each date field has the full power of your date dimension - fiscal periods, holidays, weekdays - without duplicating code!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-extensions">Custom Extensions<a href="#custom-extensions" class="hash-link" aria-label="Direct link to Custom Extensions" title="Direct link to Custom Extensions">‚Äã</a></h3>
<p>You can also selectively override or add to extended cubes:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ship_dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dimensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> days_to_ship</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DATEDIFF({orders.order_date}, {CUBE.date})&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Days between order and shipment&quot;</span><br></span></code></pre></div></div>
<h1>Views</h1>
<p>Views sit on top of the data graph of cubes and create a facade of your whole data model with which data consumers can interact. They are useful for defining metrics, managing governance and data access, and controlling ambiguous join paths.</p>
<p><img decoding="async" loading="lazy" alt="Cubes and Views" src="/cube-workshop/assets/images/cubes_views-e26be8af1948a6c005bd2f9f6b0e2ac1.png" width="1642" height="1014" class="img_ev3q"></p>
<p>Views do <strong>not</strong> define their own members.  Instead they reference cubes by specific join paths and include their members.</p>
<p>You simply define a view that includes all the measures and related dimensions you want to expose, and optionally a folder structure for organizing the fields in tools like Tableau, Power BI, and Excel. The end user can then query this view directly as a single data source through any Cube API.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-sales-view">Creating a Sales View<a href="#creating-a-sales-view" class="hash-link" aria-label="Direct link to Creating a Sales View" title="Direct link to Creating a Sales View">‚Äã</a></h2>
<p>To create a view, it&#x27;s a best practice define it in a separate YAML file. <strong>Important</strong>: Generally you&#x27;ll use the lowest granularity cube with the measures you want in the view - typically one tied to a fact table as your base. In our case, that&#x27;s <code>line_items</code> since it contains the actual sales transactions:</p>
<p>Hover over the <code>/model/views</code> directory in the Cube Cloud IDE and click the <strong>...</strong>* menu, then the <strong>New File</strong> button. Name the file <code>sales.yml</code> and add the following content:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">model/views/sales.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">views</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Sales analytics view with line items as base grain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cubes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Base cube - line items (lowest granularity)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> quantity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> extended_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> discount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> tax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> return_flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> line_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ship_date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ship_mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> total_quantity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> total_sales_amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> total_discount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> discount_rate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Product information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items.parts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> brand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> manufacturer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> retail_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Supplier information  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items.suppliers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> account_balance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">excludes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> phone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Order information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items.orders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> order_date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> priority</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> order_size_category</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> average_order_value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Customer information via orders</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items.orders.customers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> segment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> account_balance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">excludes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> phone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Geographic data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items.orders.customers.customer_nations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">alias</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">join_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> line_items.orders.customers.customer_nations.customer_regions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">includes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">alias</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> region</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> region_key</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-this-enables">What This Enables<a href="#what-this-enables" class="hash-link" aria-label="Direct link to What This Enables" title="Direct link to What This Enables">‚Äã</a></h2>
<p>With this view, end users can:</p>
<ul>
<li><strong>Analyze at the transaction level</strong>: Every row represents an actual line item sale</li>
<li><strong>Access key business metrics</strong>: Total sales amount (with discounts applied), quantity sold, discount impact</li>
<li><strong>Access related data seamlessly</strong>: Product, customer, supplier, and geographic data in one query</li>
<li><strong>Use business-friendly field names</strong>: Fields like <code>customer_name</code>, <code>product_brand</code>, <code>nation</code>, <code>region</code></li>
<li><strong>Calculate accurate aggregations</strong>: Revenue, quantity, and counts roll up correctly from line item grain</li>
<li><strong>Avoid grain mismatches</strong>: No mixing of order-level and line-level metrics</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-business-metrics-in-the-view">Key Business Metrics in the View<a href="#key-business-metrics-in-the-view" class="hash-link" aria-label="Direct link to Key Business Metrics in the View" title="Direct link to Key Business Metrics in the View">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="line-item-measures">Line Item Measures<a href="#line-item-measures" class="hash-link" aria-label="Direct link to Line Item Measures" title="Direct link to Line Item Measures">‚Äã</a></h3>
<ul>
<li><strong><code>total_sales_amount</code></strong>: Net revenue after discounts <code>(extended_price * (1 - discount))</code></li>
<li><strong><code>total_quantity</code></strong>: Units sold across all transactions</li>
<li><strong><code>total_discount</code></strong>: Total discount amount in dollars <code>(discount_rate * extended_price)</code></li>
<li><strong><code>discount_rate</code></strong>: Effective discount rate as percentage of total sales <code>(total_discount / total_sales_amount)</code></li>
<li><strong><code>count</code></strong>: Number of line items (transaction volume)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="order-measures">Order Measures<a href="#order-measures" class="hash-link" aria-label="Direct link to Order Measures" title="Direct link to Order Measures">‚Äã</a></h3>
<ul>
<li><strong><code>average_order_value</code></strong>: Average revenue per order calculated as <code>total_revenue / count</code></li>
<li><strong><code>count</code></strong>: Number of orders</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="view-design-principles">View Design Principles<a href="#view-design-principles" class="hash-link" aria-label="Direct link to View Design Principles" title="Direct link to View Design Principles">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="correct-granularity">Correct Granularity<a href="#correct-granularity" class="hash-link" aria-label="Direct link to Correct Granularity" title="Direct link to Correct Granularity">‚Äã</a></h3>
<ul>
<li><strong>Base</strong>: <code>line_items</code> - Lowest grain (actual sales transactions)</li>
<li><strong>Why not orders?</strong> - Orders are aggregated line items; line items show what was actually sold.  Orders have multiple line items with differnt parts and suppliers.</li>
<li><strong>Aggregation direction</strong>: Generally aggregate UP from lower to higher levels, unless your lower grain has no dimensions (or joins to dimensions) in your view</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="join-path-strategy">Join Path Strategy<a href="#join-path-strategy" class="hash-link" aria-label="Direct link to Join Path Strategy" title="Direct link to Join Path Strategy">‚Äã</a></h3>
<ul>
<li><code>line_items</code> - Base transaction data</li>
<li><code>line_items.parts</code> - What products were sold</li>
<li><code>line_items.suppliers</code> - Who supplied the products</li>
<li><code>line_items.orders.customers</code> - Who bought them (traverse through orders)</li>
<li><code>line_items.orders.customers.customer_nations</code> - Geographic context</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="field-control-best-practices">Field Control Best Practices<a href="#field-control-best-practices" class="hash-link" aria-label="Direct link to Field Control Best Practices" title="Direct link to Field Control Best Practices">‚Äã</a></h3>
<ul>
<li><strong>includes</strong>: Only fields needed for analysis</li>
<li><strong>excludes</strong>: Remove sensitive data (phone, address, comments)</li>
<li><strong>prefix</strong>: Prevent naming conflicts (<code>customer_name</code> vs <code>product_name</code>)</li>
<li><strong>alias</strong>: Create intuitive names (<code>nation</code> instead of generic <code>name</code>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="benefits-for-end-users">Benefits for End Users<a href="#benefits-for-end-users" class="hash-link" aria-label="Direct link to Benefits for End Users" title="Direct link to Benefits for End Users">‚Äã</a></h3>
<ol>
<li><strong>Correct Analysis</strong>: Aggregations work properly at line item grain</li>
<li><strong>Rich Context</strong>: Product, customer, supplier, and geography in one place</li>
<li><strong>Clean Schema</strong>: Only relevant, business-friendly fields</li>
<li><strong>Accurate Metrics</strong>: Revenue and quantity calculations are precise</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="complete-model-files">Complete Model Files<a href="#complete-model-files" class="hash-link" aria-label="Direct link to Complete Model Files" title="Direct link to Complete Model Files">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-starter-files">üìÅ Starter Files<a href="#-starter-files" class="hash-link" aria-label="Direct link to üìÅ Starter Files" title="Direct link to üìÅ Starter Files">‚Äã</a></h3>
<p><strong>Location</strong>: <code>static/cube-models/starter/</code></p>
<p>Contains:</p>
<ul>
<li>Basic cubes with dimensions and count measures</li>
<li>Most joins (missing one for exercise)</li>
<li>Foundation for building upon</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-data-modeling-complete">üìÅ Data Modeling Complete<a href="#-data-modeling-complete" class="hash-link" aria-label="Direct link to üìÅ Data Modeling Complete" title="Direct link to üìÅ Data Modeling Complete">‚Äã</a></h3>
<p><strong>Location</strong>: <code>static/cube-models/data-modeling/</code></p>
<p>Contains:</p>
<ul>
<li>All revenue measures</li>
<li>Subquery dimensions</li>
<li>Binning dimensions</li>
<li>Multi-level measure dependencies</li>
<li>Complete join relationships</li>
<li><strong>Sales View</strong> - Denormalized cube perfect for dashboards and reporting</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-your-sales-view-to-production">Deploying Your Sales View to Production<a href="#deploying-your-sales-view-to-production" class="hash-link" aria-label="Direct link to Deploying Your Sales View to Production" title="Direct link to Deploying Your Sales View to Production">‚Äã</a></h2>
<p>Now that you&#x27;ve built a comprehensive sales view with all the business metrics, it&#x27;s time to deploy your changes to production so they can be used by applications and end users.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="final-exercise-commit-your-changes">Final Exercise: Commit your Changes<a href="#final-exercise-commit-your-changes" class="hash-link" aria-label="Direct link to Final Exercise: Commit your Changes" title="Direct link to Final Exercise: Commit your Changes">‚Äã</a></h3>
<p><strong>Step 1: Review Your Changes</strong></p>
<ol>
<li><strong>Ensure you&#x27;re in Development Mode</strong> - Look for the &quot;Dev Mode&quot; indicator</li>
<li><strong>Test your sales view</strong> one final time in the Playground:<!-- -->
<ul>
<li>Query <code>sales.total_sales_amount</code> by <code>sales.region</code></li>
<li>Query <code>sales.parts_brand</code> with <code>sales.total_quantity</code></li>
<li>Verify all field names and calculations are correct</li>
</ul>
</li>
</ol>
<p><strong>Step 2: Commit Your Development Branch</strong></p>
<ol>
<li><strong>Navigate to the Data Model page</strong></li>
<li><strong>Review all your changes</strong> - You should see modified files and changes highlighted on the <strong>Changes</strong> diff tab</li>
<li><strong>Click Commit &amp; Sync</strong></li>
<li><strong>Add a descriptive commit message</strong>:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Add comprehensive sales view with line item metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Created sales view with line_items as base grain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Included product, customer, supplier, and geographic dimensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Added revenue, quantity, and discount measures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Configured proper field prefixes and aliases for clarity</span><br></span></code></pre></div></div>
</li>
<li><strong>Click &quot;Commit &amp; Sync&quot;</strong> to save your changes to the development branch</li>
</ol>
<p>We&#x27;ll not merge to production just yet, since there&#x27;s more work to do.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-youve-accomplished">What You&#x27;ve Accomplished<a href="#what-youve-accomplished" class="hash-link" aria-label="Direct link to What You&#x27;ve Accomplished" title="Direct link to What You&#x27;ve Accomplished">‚Äã</a></h3>
<p>Congratulations! You&#x27;ve successfully:</p>
<p>‚úÖ <strong>Learned Cube&#x27;s development workflow</strong> - Safe, isolated development with Git integration<br>
<!-- -->‚úÖ <strong>Enhanced the orders cube</strong> - Added revenue metrics and business logic<br>
<!-- -->‚úÖ <strong>Built complex relationships</strong> - Subqueries, joins, and measure dependencies<br>
<!-- -->‚úÖ <strong>Created a comprehensive sales view</strong> - Line item grain with rich dimensional context<br>
<!-- -->‚úÖ <strong>Deployed to production</strong> - Your changes are now live and ready for applications</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="business-friendly-data-model">Business-Friendly Data Model<a href="#business-friendly-data-model" class="hash-link" aria-label="Direct link to Business-Friendly Data Model" title="Direct link to Business-Friendly Data Model">‚Äã</a></h3>
<p>Your sales view now provides:</p>
<ul>
<li><strong>üéØ Correct granularity</strong>: Line item level for accurate transaction analysis</li>
<li><strong>üìä Key business metrics</strong>: Revenue, quantity, discounts with proper calculations</li>
<li><strong>üåê Rich context</strong>: Product, customer, supplier, and geographic dimensions</li>
<li><strong>üîó Clean relationships</strong>: Proper join paths preventing fan-out issues</li>
<li><strong>üìù Business-friendly naming</strong>: Intuitive field names and aliases</li>
</ul>
<p>This data model is well on its way to power dashboards, reports, and applications with consistent, reliable business metrics.</p>
<hr>
<p><strong>Next</strong>: <a href="/cube-workshop/docs/access-control">Access Control ‚Üí</a> - Learn how to secure your data with row-level security.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cube-workshop/docs/setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Workshop Setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cube-workshop/docs/access-control"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Access Control with Cube</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-data-modeling-matters" class="table-of-contents__link toc-highlight">Why Data Modeling Matters</a></li><li><a href="#the-tpc-h-schema" class="table-of-contents__link toc-highlight">The TPC-H Schema</a></li><li><a href="#visualizing-the-tpc-h-schema-in-cube" class="table-of-contents__link toc-highlight">Visualizing the TPC-H Schema in Cube</a></li><li><a href="#your-first-query" class="table-of-contents__link toc-highlight">Your First Query</a></li><li><a href="#core-concepts" class="table-of-contents__link toc-highlight">Core Concepts</a><ul><li><a href="#what-we-skipped-starting-from-scratch" class="table-of-contents__link toc-highlight">What We Skipped: Starting From Scratch</a></li><li><a href="#cubes-data-models" class="table-of-contents__link toc-highlight">Cubes (Data Models)</a></li><li><a href="#measures" class="table-of-contents__link toc-highlight">Measures</a></li><li><a href="#dimensions" class="table-of-contents__link toc-highlight">Dimensions</a></li></ul></li><li><a href="#development-mode-vs-production" class="table-of-contents__link toc-highlight">Development Mode vs Production</a><ul><li><a href="#understanding-the-cube-development-workflow" class="table-of-contents__link toc-highlight">Understanding the Cube Development Workflow</a></li><li><a href="#entering-development-mode" class="table-of-contents__link toc-highlight">Entering Development Mode</a></li><li><a href="#what-development-mode-enables" class="table-of-contents__link toc-highlight">What Development Mode Enables</a></li><li><a href="#development-api-endpoint" class="table-of-contents__link toc-highlight">Development API Endpoint</a></li><li><a href="#making-changes-safely" class="table-of-contents__link toc-highlight">Making Changes Safely</a></li><li><a href="#committing-and-deploying-to-production" class="table-of-contents__link toc-highlight">Committing and Deploying to Production</a></li><li><a href="#why-this-workflow-matters" class="table-of-contents__link toc-highlight">Why This Workflow Matters</a></li></ul></li><li><a href="#your-first-data-model" class="table-of-contents__link toc-highlight">Your First Data Model</a><ul><li><a href="#exercise-add-revenue-metrics" class="table-of-contents__link toc-highlight">Exercise: Add Revenue Metrics</a></li><li><a href="#test-your-model-in-the-playground" class="table-of-contents__link toc-highlight">Test Your Model in the Playground</a></li><li><a href="#the-power-of-reusability" class="table-of-contents__link toc-highlight">The Power of Reusability</a></li></ul></li><li><a href="#joins-and-relationships" class="table-of-contents__link toc-highlight">Joins and Relationships</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#common-cube-parameters" class="table-of-contents__link toc-highlight">Common Cube Parameters</a><ul><li><a href="#visibility-control" class="table-of-contents__link toc-highlight">Visibility Control</a></li><li><a href="#metadata-for-discovery" class="table-of-contents__link toc-highlight">Metadata for Discovery</a></li><li><a href="#sql-flexibility" class="table-of-contents__link toc-highlight">SQL Flexibility</a></li><li><a href="#refresh-keys-for-cache-invalidation" class="table-of-contents__link toc-highlight">Refresh Keys for Cache Invalidation</a></li><li><a href="#data-source-routing" class="table-of-contents__link toc-highlight">Data Source Routing</a></li></ul></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a><ul><li><a href="#exercise-1-complete-the-missing-join" class="table-of-contents__link toc-highlight">Exercise 1: Complete the Missing Join</a></li><li><a href="#exercise-2-add-subquery-dimensions" class="table-of-contents__link toc-highlight">Exercise 2: Add Subquery Dimensions</a></li><li><a href="#exercise-3-business-logic-with-binning" class="table-of-contents__link toc-highlight">Exercise 3: Business Logic with Binning</a></li><li><a href="#exercise-4-multi-level-measure-dependencies" class="table-of-contents__link toc-highlight">Exercise 4: Multi-Level Measure Dependencies</a></li></ul></li><li><a href="#understanding-relationships--fan-outs" class="table-of-contents__link toc-highlight">Understanding Relationships &amp; Fan-Outs</a><ul><li><a href="#why-relationship-direction-matters" class="table-of-contents__link toc-highlight">Why Relationship Direction Matters</a></li><li><a href="#fan-out-prevention" class="table-of-contents__link toc-highlight">Fan-Out Prevention</a></li></ul></li><li><a href="#the-power-of-extends" class="table-of-contents__link toc-highlight">The Power of Extends</a><ul><li><a href="#why-our-model-uses-extends" class="table-of-contents__link toc-highlight">Why Our Model Uses Extends</a></li><li><a href="#date-tables-a-common-use-case-for-extends" class="table-of-contents__link toc-highlight">Date Tables: A Common Use Case for Extends</a></li><li><a href="#custom-extensions" class="table-of-contents__link toc-highlight">Custom Extensions</a></li></ul></li><li><a href="#creating-a-sales-view" class="table-of-contents__link toc-highlight">Creating a Sales View</a></li><li><a href="#what-this-enables" class="table-of-contents__link toc-highlight">What This Enables</a></li><li><a href="#key-business-metrics-in-the-view" class="table-of-contents__link toc-highlight">Key Business Metrics in the View</a><ul><li><a href="#line-item-measures" class="table-of-contents__link toc-highlight">Line Item Measures</a></li><li><a href="#order-measures" class="table-of-contents__link toc-highlight">Order Measures</a></li></ul></li><li><a href="#view-design-principles" class="table-of-contents__link toc-highlight">View Design Principles</a><ul><li><a href="#correct-granularity" class="table-of-contents__link toc-highlight">Correct Granularity</a></li><li><a href="#join-path-strategy" class="table-of-contents__link toc-highlight">Join Path Strategy</a></li><li><a href="#field-control-best-practices" class="table-of-contents__link toc-highlight">Field Control Best Practices</a></li><li><a href="#benefits-for-end-users" class="table-of-contents__link toc-highlight">Benefits for End Users</a></li></ul></li><li><a href="#complete-model-files" class="table-of-contents__link toc-highlight">Complete Model Files</a><ul><li><a href="#-starter-files" class="table-of-contents__link toc-highlight">üìÅ Starter Files</a></li><li><a href="#-data-modeling-complete" class="table-of-contents__link toc-highlight">üìÅ Data Modeling Complete</a></li></ul></li><li><a href="#deploying-your-sales-view-to-production" class="table-of-contents__link toc-highlight">Deploying Your Sales View to Production</a><ul><li><a href="#final-exercise-commit-your-changes" class="table-of-contents__link toc-highlight">Final Exercise: Commit your Changes</a></li><li><a href="#what-youve-accomplished" class="table-of-contents__link toc-highlight">What You&#39;ve Accomplished</a></li><li><a href="#business-friendly-data-model" class="table-of-contents__link toc-highlight">Business-Friendly Data Model</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Workshop</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cube-workshop/docs/intro">Getting Started</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Cube Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cube.dev/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://slack.cube.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/cube-js/cube" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cube.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cube.dev<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://cube.dev/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 Cube Dev, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>